!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(module,__webpack_exports__,__webpack_require__){"use strict";var zqyl_expire=0,zqyl_timestamp="",zqyl_now=zqyl_timestamp=Date.parse(new Date)/1e3;function send_request(e){let t=null;if(window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),null!=t){let n=e;return t.open("GET",n,!1),t.send(null),t.responseText}alert("Your browser does not support XMLHTTP.")}async function get_signature(tokenUrl){let zqyl_timestamp="",zqyl_now=zqyl_timestamp=Date.parse(new Date)/1e3;if(zqyl_expire<zqyl_now+3){let zqyl_body=await send_request(tokenUrl),obj=eval("("+zqyl_body+")"),zqyl_host=obj.host,zqyl_policyBase64=obj.policy,zqyl_accessid=obj.accessid,zqyl_signature=obj.signature,zqyl_expire=parseInt(obj.expire),zqyl_callbackbody=obj.callback,zqyl_key=obj.dir;return{zqyl_host:zqyl_host,zqyl_policyBase64:zqyl_policyBase64,zqyl_accessid:zqyl_accessid,zqyl_signature:zqyl_signature,zqyl_expire:zqyl_expire,zqyl_callbackbody:zqyl_callbackbody,zqyl_key:zqyl_key}}}__webpack_exports__.a=get_signature},function(e,t,n){"use strict";n.r(t);var o=n(0);var r=function(e,t){const n=1048576*t.fileSizeLimit;return t.fileTypeExts.indexOf(e.type.split("/")[1])<0?(alert("文件类型仅支持 jpeg/png/gif！"),!1):!(e.size>n&&(alert(`文件大小不能超过${t.fileSizeLimit}10MB！`),1))};var a=function(e,t,n,o){const r=new FormData;return r.append("name",n,t),r.append("key",o.zqyl_key+t),r.append("policy",o.zqyl_policyBase64),r.append("OSSAccessKeyId",o.zqyl_accessid),r.append("success_action_status",200),r.append("callback",o.zqyl_callbackbody),r.append("signature",o.zqyl_signature),r.append("x:url",`${o.zqyl_host}/${o.zqyl_key}${t}`),r.append("x:appid",n),r.append("file",e),r};var l=function(e,t){const n=1024*t*1024,o=new FileReader;return o.readAsDataURL(e),new Promise((e,t)=>{o.onload=function(t){const o=t.target.result;o.length<n?e({dataUrl:o,shouldCompress:!1}):e({dataUrl:o,shouldCompress:!0})}})};var i=function(e,t=!0,n){const o=new window.Image;return o.src=e,new Promise((e,r)=>{o.onload=function(){const r=document.createElement("canvas"),a=r.getContext("2d");let l;r.width=o.width,r.height=o.height,a.drawImage(o,0,0,r.width,r.height),l=t?r.toDataURL(n,.8):r.toDataURL(n,1),e(l)}})};var s=function(e,t){const n=window.atob(e.split(",")[1]),o=new ArrayBuffer(n.length),r=new Uint8Array(o);for(let e=0,t=n.length;e<t;e++)r[e]=n.charCodeAt(e);const a=[r];let l;try{l=new Blob(a,{type:t})}catch(e){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"!==e.name||!window.BlobBuilder)throw new Error("版本过低，不支持上传图片");{const e=new BlobBuilder;e.append(o),l=e.getBlob(t)}}return l};var c=function(e,t){e=e||32;for(var n="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",o=n.length,r="",a=0;a<e;a++)r+=n.charAt(Math.floor(Math.random()*o));return r+function(e){var t=e.lastIndexOf("."),n="";return-1!=t&&(n=e.substring(t)),n}(t)};let u="xxx",p={};window.zqyl_fileH5Upload={uploadFile:async function(e,t){if(u=t.appid,!r(e,t))return!1;p=await Object(o.a)(t.tokenUrl);let n={},d="";if(window.navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/))n=a(e,u,p);else if(t.compress){let o=await l(e,t.compressMinSize),r=await i(o.dataUrl,o.shouldCompress,e.type||"image/jpeg"),y=s(r,e.type||"image/jpeg"),_=new File([y],e.name);d=c(15,_.name),n=a(_,d,u,p)}else d=c(15,e.name),n=a(e,d,u,p);const y=new XMLHttpRequest;y.onloadstart=t.onUploadStart,y.onprogress=t.onProgress,y.onerror=t.onUploadError,y.onload=function(){},y.ontimeout=function(){alert("请求超时请重试！")},y.onreadystatechange=function(){if(4===y.readyState)200===y.status?t.onUploadSuccess(`${p.zqyl_host}/${p.zqyl_key}${d}`):t.onUploadError(`${y.status}`);else if(203===y.status){let e=JSON.parse(y.responseText);alert(e)}},y.open("POST",p.zqyl_host,!0),y.send(n)}}}]);